Refactor: handleAllTicketsMode

This commit:
 - Seaprates flow logic for handling the all tickets mode into the modes class
 - Provides better readability for the main function